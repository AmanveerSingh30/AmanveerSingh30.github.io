<div class="stage-container puzzle-stage">
  <!-- Clean dark blue gradient background -->
  <div class="dark-blue-bg-overlay"></div>

  <!-- Rain drops container -->
  <div class="rain-drops">
    <!-- Raindrops will be dynamically added by the component -->
  </div>


  <!-- ILY dribble gif in bottom left corner with triple click to skip -->
  <div class="ily-dribble-container" (click)="handleIlyClick($event)">
    <img src="assets/ily_dribble.gif" alt="ILY Dribble" class="ily-dribble-gif">
  </div>

  <div class="puzzle-grid">
    <ng-container *ngFor="let position of [0, 1, 2, 3, 4, 5, 6, 7, 8]">
      <div
        class="puzzle-piece"
        [class.selected]="getPieceByPosition(position).isSelected"
        (click)="onPieceClick(getPieceByPosition(position))"
      >
        <img
          [src]="getImagePath(getPieceByPosition(position))"
          [alt]="'Puzzle piece ' + getPieceByPosition(position).id"
          draggable="false"
        >
      </div>
    </ng-container>
  </div>

  <div class="puzzle-message" *ngIf="isCompleted">
    <h2>:/</h2>
    <div class="buttons-container">
      <button class="next-button" (click)="goToNextStage()">Continue</button>
    </div>
  </div>
</div>
